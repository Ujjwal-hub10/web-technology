"use strict";(globalThis.webpackChunkcalypso=globalThis.webpackChunkcalypso||[]).push([[60650],{"./components/data/query-site-stats/constants.js":(t,e,s)=>{s.d(e,{c:()=>a});const a=18e5},"./components/data/query-site-stats/index.jsx":(t,e,s)=>{s.d(e,{Z:()=>b});var a=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=s("../node_modules/@wordpress/is-shallow-equal/build-module/index.js"),n=s("../node_modules/lodash-es/defer.js"),o=s("../node_modules/react/index.js"),i=s("../node_modules/react-redux/es/index.js"),l=s("./lib/wp/browser.js"),u=s("./state/action-types.ts"),d=(s("./state/stats/init.js"),s("./state/stats/emails/constants.js"));const c={statsInsights:"stats/insights",statsFileDownloads:"stats/file-downloads",statsAds:"wordads/stats",statsEmailsSummary:"stats/emails/summary",statsEmailsSummaryByOpens:"stats/emails/summary"},p={statsOrders:"stats/orders",statsTopSellers:"stats/top-sellers",statsTopEarners:"stats/top-earners",statsTopCategories:"stats/top-product-categories-by-usage",statsTopCoupons:"stats/top-coupons-by-usage"};var m=s("./state/stats/lists/selectors.js"),y=s("./state/stats/lists/utils.js"),h=s("./components/data/query-site-stats/constants.js");class f extends o.Component{constructor(...t){super(...t),(0,a.Z)(this,"heartbeatRequest",(()=>{const{requesting:t,siteId:e,statType:s,query:a}=this.props;t||this.props.requestSiteStats(e,s,a)}))}componentDidMount(){this.deferredTimer=(0,n.Z)((()=>this.request()))}componentDidUpdate(t){this.props.siteId===t.siteId&&this.props.statType===t.statType&&(0,r.ZP)(this.props.query,t.query)||this.request()}componentWillUnmount(){this.clearInterval(),clearTimeout(this.deferredTimer)}request(){const{requesting:t,siteId:e,statType:s,query:a,heartbeat:r}=this.props;t||(this.props.requestSiteStats(e,s,a),this.clearInterval(),r&&(0,y.l4)(a)&&(this.interval=setInterval(this.heartbeatRequest,r)))}clearInterval(){this.interval&&clearInterval(this.interval)}render(){return null}}f.defaultProps={query:{},heartbeat:h.c};const b=(0,i.$j)(((t,{siteId:e,statType:s,query:a})=>({requesting:(0,m.dp)(t,e,s,a)})),{requestSiteStats:function(t,e,s){return a=>{let r,n;a({type:u.qjQ,statType:e,siteId:t,query:s}),c.hasOwnProperty(e)?r=c[e]:p.hasOwnProperty(e)&&(r=p[e],n="wpcom/v2");const o=(()=>{switch(e){case"statsVideo":return s.postId;case"statsEmailsSummary":return{period:d.f,quantity:s.quantity??10,sort_field:s.sort_field??"post_id",sort_order:s.sort_order??"desc"};case"statsEmailsSummaryByOpens":return{period:d.f,quantity:s.quantity??10,sort_field:"opens",sort_order:"desc"};default:return s}})();return(r?l.Z.req.get({path:`/sites/${t}/${r}`,apiNamespace:n},o):l.Z.site(t)[e](o,"statsVideo"===e?{statType:s.statType,period:s.period}:{})).then((r=>a(function(t,e,s,a,r){return{type:u.bu8,statType:e,siteId:t,query:s,data:a,date:r}}(t,e,s,r,Date.now())))).catch((r=>{a({type:u.LY5,statType:e,siteId:t,query:s,error:r})}))}}})(f)},"./state/stats/chart-tabs/constants.js":(t,e,s)=>{s.d(e,{B:()=>a});const a=["views","visitors","likes","comments","post_titles","opens_count","unique_opens_count"]},"./state/stats/emails/constants.js":(t,e,s)=>{s.d(e,{f:()=>a});const a="alltime"},"./state/stats/init.js":(t,e,s)=>{var a=s("./state/redux-store.ts"),r=s("../packages/state-utils/src/index.ts"),n=s("./state/utils/reducer-utils.ts"),o=s("../node_modules/lodash-es/isEqual.js"),i=s("../node_modules/lodash-es/set.js"),l=s("../node_modules/lodash-es/pick.js"),u=s("./state/action-types.ts"),d=s("./state/utils/schema-utils.js"),c=s("./state/utils/keyed-reducer.ts"),p=s("./state/utils/with-persistence.ts"),m=s("./state/stats/chart-tabs/constants.js");const y=(0,d.G)({type:"object",patternProperties:{"^\\d+$":{type:"object",patternProperties:{"^\\w+$":{type:"array",items:{type:"object",required:["period","labelDay"],properties:{classNames:{type:"array",items:{type:"string"}},comments:{type:"number"},labelDay:{type:"string"},likes:{type:"number"},period:{type:"string"},postTitles:{type:"array",items:{type:"string"}},views:{type:"number"},visitors:{type:"number"}}}}}}}},(0,c.J)("siteId",(0,c.J)("period",(0,p.$)(((t=[],e)=>{if(e.type===u.iv7){if(e.data.length!==t.length||!(0,o.Z)(e.data[0].period,t[0].period))return e.data;let s=!1;const a=e.data.reduce(((t,e)=>{const a=t.findIndex((t=>t.period===e.period));if(a>=0){const r={...t[a],...e};(0,o.Z)(t[a],r)||(s=!0,t[a]=r)}else s=!0,t.push(e);return t}),[...t]);return s?a:t}return t}))))),h=(0,c.J)("siteId",(0,c.J)("period",((t={},e)=>{switch(e.type){case u.cly:return e.statFields.reduce(((t,e)=>(0,i.Z)(t,e,!0)),{...t});case u.iv7:return Object.keys((0,l.Z)(e.data[0],m.B)).reduce(((t,e)=>(0,i.Z)(t,e,!1)),{...t})}return t}))),f=(0,n.U)({counts:y,isLoading:h});var b=s("../node_modules/lodash-es/merge.js"),g=s("./state/stats/emails/constants.js");const v=(0,d.G)({type:"object",additionalProperties:!1,patternProperties:{"^\\d+$":{type:"object",additionalProperties:!1,patternProperties:{"^\\d+$":{type:"object"}}}}},((t={},e)=>{if(e.type===u.RFj){const{siteId:s,postId:a,period:r,statType:n}=e;return(0,b.Z)({},t,{[s]:{[a]:{[r]:{[n]:e.stats}}}})}return t})),w=(0,n.U)({items:v,requests:(t={},e)=>{switch(e.type){case u.P5N:case u.RFj:case u.teD:const{siteId:s,postId:a,period:r,statType:n,date:o}=e,i=(()=>{switch(e.type){case u.P5N:return{requesting:!0,status:"pending"};case u.RFj:return{requesting:!1,status:"success"};case u.teD:return{requesting:!0,status:"error"}}})();return r===g.f?(0,b.Z)({},t,{[s]:{[a]:{[r]:{[n]:i}}}}):(0,b.Z)({},t,{[s]:{[a]:{[r]:{[n]:{[o]:i}}}}})}return t}}),j=(0,d.G)({type:"object",patternProperties:{"^\\d+$":{type:"object",patternProperties:{counts:{type:"object",patternProperties:{comments:{type:"number"},likes:{type:"number"},views:{type:"number"},visitors:{type:"number"}}}}}}},(0,c.J)("siteId",(0,p.$)(((t={},e)=>e.type===u.nyW?e.data:t)))),Y=(0,c.J)("siteId",((t={},e)=>{switch(e.type){case u.YdM:return!0;case u.nyW:return!1}return t})),_=(0,n.U)({data:j,isLoading:Y});var k=s("../node_modules/lodash-es/get.js");var I=s("./state/stats/lists/utils.js");const M=(0,d.G)({type:"object",patternProperties:{"^\\d+$":{type:"object",patternProperties:{"^[A-Za-z]+$":{type:"object",patternProperties:{"^\\[.*\\]$":{type:"object"}},additionalProperties:!1}},additionalProperties:!1}},additionalProperties:!1},((t={},e)=>{if(e.type===u.bu8){const{siteId:s,statType:a,query:r,data:n}=e,o=(0,I.n5)(r);return{...t,[s]:{...t[s],[a]:{...(0,k.Z)(t,[s,a]),[o]:n||null}}}}return t})),q=(0,n.U)({requests:(t={},e)=>{switch(e.type){case u.qjQ:{const{siteId:s,statType:a,query:r}=e,n=(0,I.n5)(r);return(0,b.Z)({},t,{[s]:{[a]:{[n]:{requesting:!0,status:"pending"}}}})}case u.bu8:{const{siteId:s,statType:a,query:r,date:n}=e,o=(0,I.n5)(r);return(0,b.Z)({},t,{[s]:{[a]:{[o]:{requesting:!1,status:"success",date:n}}}})}case u.LY5:{const{siteId:s,statType:a,query:r}=e,n=(0,I.n5)(r);return(0,b.Z)({},t,{[s]:{[a]:{[n]:{requesting:!1,status:"error"}}}})}}return t},items:M});const Z=(0,d.G)({type:"object",additionalProperties:!1,patternProperties:{"^\\d+$":{type:"object",additionalProperties:!1,patternProperties:{"^\\d+$":{type:"object"}}}}},((t={},e)=>e.type===u.wkd?{...t,[e.siteId]:{...(0,k.Z)(t,[e.siteId],{}),[e.postId]:{...(0,k.Z)(t,[e.siteId,e.postId],{}),...e.stats}}}:t)),D=(0,n.U)({requesting:function(t={},e){switch(e.type){case u.CYP:case u._AQ:case u.VRq:return(0,b.Z)({},t,{[e.siteId]:{[e.postId]:{[e.fields.join()]:u.CYP===e.type}}})}return t},items:Z}),T=(0,d.G)({type:"object",additionalProperties:!1,patternProperties:{"^\\d+$":{type:"object",additionalProperties:!1,patternProperties:{"^\\d+$":{type:"object",properties:{views:{type:"number"}}}}}}},((t={},e)=>{if(e.type===u.PNS){const s={};return e.posts.forEach((t=>{s[t.ID]={views:t.views}})),{...t,[e.siteId]:{...(0,k.Z)(t,[e.siteId],{}),...s}}}return t})),P=(0,n.U)({items:T}),O=(0,n.U)({chartTabs:f,highlights:_,lists:q,posts:D,emails:w,recentPostViews:P}),x=(0,r.xi)("stats",O);(0,a.x)(["stats"],x)},"./state/stats/lists/selectors.js":(t,e,s)=>{s.d(e,{dp:()=>u,Ub:()=>d,gp:()=>c,qP:()=>p,fi:()=>m,fb:()=>y,XS:()=>h,LQ:()=>f,s:()=>b,sC:()=>g,HD:()=>v});var a=s("../packages/tree-select/src/index.ts"),r=s("../node_modules/lodash-es/get.js"),n=s("../node_modules/lodash-es/flatten.js"),o=s("../node_modules/lodash-es/map.js"),i=s("./state/sites/selectors/get-site.js"),l=s("./state/stats/lists/utils.js");s("./state/stats/init.js");function u(t,e,s,a){const n=(0,l.n5)(a);return!!(0,r.Z)(t.stats.lists.requests,[e,s,n,"requesting"])}function d(t,e,s,a){const n=(0,l.n5)(a);return"error"===(0,r.Z)(t.stats.lists.requests,[e,s,n,"status"])}function c(t,e,s,a){const n=(0,l.n5)(a);return(0,r.Z)(t.stats.lists.items,[e,s,n],null)}const p=(0,a.Z)(((t,e,s)=>[c(t,e,"statsStreak",s)]),(([t],e,s)=>{const a=s.gmtOffset||0,r={};return t&&t.data&&!Array.isArray(t.data)&&Object.keys(t.data).forEach((e=>{const s=new Date(1e3*e);s.setUTCHours(s.getUTCHours()+a);const n=s.toISOString().slice(0,10);void 0===r[n]&&(r[n]=0),r[n]+=t.data[e]})),r}),{getCacheKey:(t,e)=>[t,(0,l.n5)(e)].join()}),m=(0,a.Z)(((t,e,s,a)=>[c(t,e,s,a),(0,i.Z)(t,e)]),(([t])=>t),{getCacheKey:(t,e,s)=>[t,e,(0,l.n5)(s)].join()}),y=(0,a.Z)(((t,e,s,a)=>[c(t,e,s,a),(0,i.Z)(t,e)]),(([t,e],s,a,r)=>{const n=l.oq[a];return"function"!=typeof n?t:n(t,r,s,e)}),{getCacheKey:(t,e,s)=>[t,e,(0,l.n5)(s)].join()});function h(t,e,s,a){const r=y(t,e,s,a);return r&&Array.isArray(r)?(0,n.Z)((0,o.Z)(r,(t=>(0,l.K7)(t)))):[]}function f(t,e,s,a){const n=(0,l.n5)(a);return(0,r.Z)(t.stats.lists.requests,[e,s,n,"date"])}function b(t,e){const s=c(t,e,"statsVisits",{stat_fields:"views",quantity:-1});if(!s||!s.data)return null;const a={};s.data.forEach((t=>{const[e,s]=t,r=new Date(e),n=r.getFullYear(),o=r.getMonth();a[n]||(a[n]={}),a[n][o]||(a[n][o]={total:0,data:[],average:0,daysInMonth:new Date(n,o+1,0).getDate()}),a[n][o].total+=s,a[n][o].data.push(t);const i=a[n][o].total/a[n][o].daysInMonth;a[n][o].average=Math.round(i)}));const r=new Date,n=a[r.getFullYear()]&&a[r.getFullYear()][r.getMonth()];return n&&(n.daysInMonth=r.getDate(),n.average=Math.round(n.total/n.daysInMonth)),a}const g=(t,e,s)=>{const a=y(t,e,"statsInsights",s);return{day:a?.day,time:a?.hour}},v=(t,e,s)=>{const a=c(t,e,"statsTopPosts",s);if(!a)return{post:null,page:null};const r={};Object.values(a.days).forEach((({postviews:t})=>{t.forEach((t=>{t.id in r?r[t.id].views+=t.views:r[t.id]=t}))}));const n=Object.values(r).sort(((t,e)=>t.views>e.views?-1:t.views<e.views?1:0));return n.length?{post:n.find((({type:t})=>"post"===t)),page:n.find((({type:t})=>"page"===t))}:{post:null,page:null}}},"./state/stats/lists/utils.js":(t,e,s)=>{s.d(e,{K7:()=>v,Xk:()=>Y,le:()=>h,n5:()=>w,l4:()=>b,oq:()=>M,Dy:()=>k,tD:()=>f});var a=s("../packages/i18n-calypso/src/index.js"),r=s("../node_modules/lodash-es/map.js"),n=s("../node_modules/lodash-es/concat.js"),o=s("../node_modules/lodash-es/flatten.js"),i=s("../node_modules/lodash-es/sortBy.js"),l=s("../node_modules/lodash-es/mapKeys.js"),u=s("../node_modules/lodash-es/camelCase.js"),d=s("../node_modules/lodash-es/get.js"),c=s("../node_modules/lodash-es/filter.js"),p=s("../node_modules/moment/moment.js"),m=s.n(p);const y={twitter:{label:"Twitter",icon:"https://secure.gravatar.com/blavatar/7905d1c4e12c54933a44d19fcd5f9356?s=48"},facebook:{label:"Facebook",icon:"https://secure.gravatar.com/blavatar/2343ec78a04c6ea9d80806345d31fd78?s=48"},tumblr:{label:"Tumblr",icon:"https://secure.gravatar.com/blavatar/84314f01e87cb656ba5f382d22d85134?s=48"},google_plus:{label:"Google+",icon:"https://secure.gravatar.com/blavatar/4a4788c1dfc396b1f86355b274cc26b3?s=48"},linkedin:{label:"LinkedIn",icon:"https://secure.gravatar.com/blavatar/f54db463750940e0e7f7630fe327845e?s=48"},path:{label:"Path",icon:"https://secure.gravatar.com/blavatar/3a03c8ce5bf1271fb3760bb6e79b02c1?s=48"}};function h(t,e){const s=e.toString();switch(t){case"week":return 8===s.length&&"-W"===s.substr(4,2)?"YYYY-[W]WW":"YYYY-MM-DD";case"month":return 7===s.length&&"-"===s.substr(4,1)?"YYYY-MM":"YYYY-MM-DD";case"year":return 4===s.length?"YYYY":"YYYY-MM-DD";default:return"YYYY-MM-DD"}}function f(t,e){const s=h(t,e),a=m()(e,s).locale("en"),r=a.clone().startOf(t),n=a.clone().endOf(t);return"week"===t&&("0"===a.format("d")?(r.subtract(6,"d"),n.subtract(6,"d")):(r.add(1,"d"),n.add(1,"d"))),{startOf:r.format("YYYY-MM-DD"),endOf:n.format("YYYY-MM-DD")}}function b(t){if(!t||!t.date||!t.unit&&!t.period)return!0;const e=f(t.period||t.unit,t.date),s=m()();return s>=m()(e.startOf)&&s<m()(e.endOf).add(1,"day")}function g(t){if(!t)return null;const[e]=t.split("?");return e+"?d=mm"}function v(t,e=null){if(!t||!t.label||!t.value)return[];const s=e?e+" > "+t.label:t.label,a=s.replace(/\"/,'""');let i=[['"'+a+'"',t.value]];if(t.actions&&t.actions.length&&(i=[['"'+a+'"',t.value,t.actions[0].data]]),t.children){const e=(0,r.Z)(t.children,(t=>v(t,s)));i=(0,n.Z)(i,(0,o.Z)(e))}return i}function w(t={}){return JSON.stringify((0,i.Z)(Object.entries(t),(t=>t[0])))}function j(t){return t&&t.deltas&&t.delta_fields&&0!==Object.keys(t.deltas).length?t.deltas.map((e=>{const s=Object.keys(e).filter((t=>"period"!==t)),a={period:I(t.unit,e.period).format("YYYY-MM-DD")};return s.forEach((s=>{a[s]=e[s].reduce(((e,s,a)=>(e[t.delta_fields[a]]=s,e)),{})})),a})):[]}function Y(t,e,s){const r=m().isMoment(e)&&e.isValid(),n=m().isMoment(s)&&s.isValid();if(r&&n&&t){const r=e.toDate().getDay(),n="day"===t&&(6===r||0===r),o=`label${t.charAt(0).toUpperCase()+t.slice(1)}`,i={hour:(0,a.Iu)("MMM D HH:mm",{context:"momentjs format string (hour)",comment:"This specifies an hour for the stats x-axis label."}),day:(0,a.Iu)("MMM D",{context:"momentjs format string (day)",comment:"This specifies a day for the stats x-axis label."}),week:(0,a.Iu)("MMM D",{context:"momentjs format string (week)",comment:"This specifies a week for the stats x-axis label."}),month:"MMM",year:"YYYY"};return{[o]:s.format(i[t]),classNames:n?["is-weekend"]:[]}}return{}}function _(t){return t&&t.data?t.data.map((function(e){const s={};if(e.forEach((function(e,a){s[t.fields[a]]=e})),s.period){const e=I(t.unit,s.period).locale("en"),a=I(t.unit,s.period);Object.assign(s,Y(t.unit,e,a))}return s.period=I(t.unit,s.period).format("YYYY-MM-DD"),s})):[]}function k(t,e=[]){return t&&t.data?t.data.map((function(s){const r=e.reduce(((t,e)=>(t[e]=null,t)),{});if(s.forEach((function(e,s){"period"===t.fields[s]&&(e=e.replace(/W/g,"-")),r[t.fields[s]]=e})),r.period){const e=m()(r.period,"YYYY-MM-DD").locale("en"),s=(0,a.Yj)(),n=m()(r.period,"YYYY-MM-DD").locale(s);Object.assign(r,Y(t.unit,e,n))}return r})):[]}function I(t,e){let s;const r=(0,a.Yj)();switch(t){case"week":return s=e.split("-W"),m()().locale(r).isoWeekYear(s[0]).isoWeek(s[1]).endOf("isoWeek");case"month":return m()(e,"YYYY-MM").locale(r).endOf("month");case"year":return m()(e,"YYYY").locale(r).endOf("year");default:return m()(e,"YYYY-MM-DD").locale(r)}}const M={stats:t=>t&&t.stats?(0,l.Z)(t.stats,((t,e)=>(0,u.default)(e))):null,statsInsights:t=>{if(!t||"number"!=typeof t.highest_day_of_week)return{};const{highest_hour:e,highest_day_percent:s,highest_day_of_week:r,highest_hour_percent:n,hourly_views:o,years:i}=t;let l=r+1;l>6&&(l=0);const u=(0,a.Yj)();return{day:m()().locale(u).day(l).format("dddd"),percent:Math.round(s),hour:m()().locale(u).hour(e).startOf("hour").format("LT"),hourPercent:Math.round(n),hourlyViews:o,years:i}},statsTopPosts:(t,e,s,a)=>{if(!t||!e.period||!e.date)return[];const{startOf:n,endOf:o}=f(e.period,e.date),i=e.summarize?["summary","postviews"]:["days",n,"postviews"],l=(0,d.Z)(t,i,[]);return(0,r.Z)(l,(t=>{const e=a?`/stats/post/${t.id}/${a.slug}`:null;let s=!1;if(t.date){const e=m()(t.date);(e.isAfter(n,"day")||e.isSame(n,"day"))&&(e.isBefore(o,"day")||e.isSame(o,"day"))&&(s=!0)}return{id:t.id,label:t.title,value:t.views,page:e,public:t.public,actions:[{type:"link",data:t.href}],labelIcon:null,children:null,className:s?"published":null}}))},statsCountryViews:(t,e={})=>{if(!t||!e.period||!e.date)return null;const{startOf:s}=f(e.period,e.date),a=(0,d.Z)(t,["country-info"],{}),n=e.summarize?["summary","views"]:["days",s,"views"],o=(0,c.Z)((0,d.Z)(t,n,[]),(t=>a[t.country_code]));return(0,r.Z)(o,(t=>{const e=a[t.country_code];return{label:e.country_full.replace(/’/,"'"),countryCode:t.country_code,value:t.views,region:e.map_region}}))},statsPublicize:(t={})=>t&&t.services?t.services.map((t=>{const{label:e,icon:s}=y[t.service];return{label:e,icon:s,value:t.followers}})):[],statsVideoPlays(t,e={},s,a){if(!t||!e.period||!e.date)return[];const{startOf:r}=f(e.period,e.date);return(0,d.Z)(t,["days",r,"plays"],[]).map((t=>{const s=a?`/stats/${e.period}/videodetails/${a.slug}?post=${t.post_id}`:null;return{label:t.title,page:s,value:t.plays,actions:[{type:"link",data:t.url}]}}))},statsFollowers(t){if(!t)return null;const{total_wpcom:e,total_email:s}=t;return{total_wpcom:e,total_email:s,subscribers:(0,d.Z)(t,["subscribers"],[]).map((t=>({label:t.label,iconClassName:"avatar-user",icon:g(t.avatar),link:t.url,value:{type:"relative-date",value:t.date_subscribed},actions:[{type:"follow",data:!!t.follow_data&&t.follow_data.params}]})))}},statsCommentFollowers(t){if(!t)return null;const e=t.page||0,s=t.pages||0,a=t.total||0;let r=[];return t.posts&&(r=t.posts.map((t=>0===t.id?{label:"All Posts",value:t.followers}:{label:t.title,link:t.url,labelIcon:"external",value:t.followers}))),{page:e,pages:s,total:a,posts:r}},statsComments(t,e,s,a){if(!t)return null;const r=a?a.options.admin_url:null;let n=[];t.authors&&(n=t.authors.map((t=>({label:t.name,value:t.comments,iconClassName:"avatar-user",icon:g(t.gravatar),link:r+"edit-comments.php"+t.link,className:"module-content-list-item-large",actions:[{type:"follow",data:!!t.follow_data&&t.follow_data.params}]}))));let o=[];return t.posts&&(o=t.posts.map((t=>({label:t.name,value:t.comments,page:a?"/stats/post/"+t.id+"/"+a.slug:null,actions:[{type:"link",data:t.link}]})))),{authors:n,posts:o}},statsVideo(t){if(!t)return null;let e=[];t.data&&(e=t.data.map((t=>({period:t[0],value:t[1]}))));let s=[];return t.pages&&(s=t.pages.map((t=>({label:t,link:t})))),{pages:s,data:e}},statsTopAuthors(t,e={},s,r){if(!t||!e.period||!e.date)return[];const{startOf:n}=f(e.period,e.date);return(0,d.Z)(t,["days",n,"authors"],[]).map((t=>{const e={label:t.name||(0,a.Iu)("Untracked Authors"),iconClassName:"avatar-user",icon:g(t.avatar),children:null,value:t.views,className:"module-content-list-item-large"};return t.posts&&t.posts.length>0&&(e.children=t.posts.map((t=>({label:t.title,value:t.views,page:r?"/stats/post/"+t.id+"/"+r.slug:null,actions:[{type:"link",data:t.url}],children:null})))),e}))},statsTags(t){if(!t||!t.tags)return[];const e=t=>"category"===t?"folder":t;return t.tags.map((t=>{let s;const a=t.tags.length>1,r=t.tags.map((t=>({label:t.name,labelIcon:e(t.type),link:a?null:t.link})));return a&&(s=t.tags.map((t=>({label:t.name,labelIcon:e(t.type),value:null,children:null,link:t.link})))),{label:r,link:r.length>1?null:r[0].link,value:t.views,children:s}}))},statsClicks(t,e){if(!t||!e.period||!e.date)return[];const{startOf:s}=f(e.period,e.date),a=e.summarize?["summary","clicks"]:["days",s,"clicks"];return(0,d.Z)(t,a,[]).map((t=>{const e=t.children&&t.children.length>0,s={label:t.name,value:t.views,children:null,link:t.url,icon:t.icon,labelIcon:e?null:"external"};return t.children&&(s.children=t.children.map((t=>({label:t.name,value:t.views,children:null,link:t.url,labelIcon:"external"})))),s}))},statsReferrers(t,e,s){if(!t||!e.period||!e.date)return[];const{startOf:a}=f(e.period,e.date),r=e.summarize?["summary","groups"]:["days",a,"groups"];let n=(0,d.Z)(t,r,[]);const o=t=>{let e;t.children&&t.children.length>0&&(e=t.children.map(o));const s={label:t.name,value:t.views,link:t.url,labelIcon:e?null:"external",children:e};return t.icon&&(s.icon=t.icon),s};return n=n.map((t=>1===t.results?.length?{...t.results[0],group:t.results[0].name,total:t.results[0].views}:t)),n.map((t=>{let e=[];return(t.url&&-1!==t.url.indexOf(t.name)||!t.url&&t.name===t.group&&-1!==t.name.indexOf("."))&&(e=[{type:"spam",data:{siteID:s,domain:t.name}}]),{...o({...t,children:t.results,views:t.total}),actions:e,actionMenu:e.length}}))},statsVisits:t=>k(t,["visits","likes","visitors","comments","posts"]),statsOrders:t=>({data:_(t),deltas:j(t)}),statsTopSellers:t=>t&&t.data?t.data:[],statsTopCategories:t=>t&&t.data?t.data:[],statsTopCoupons:t=>t&&t.data?t.data:[],statsTopEarners:t=>t&&t.data?t.data:[],statsAds:t=>t&&t.data?k(t,["impressions","revenue","cpm"]):[],statsSearchTerms(t,e){if(!t||!e.period||!e.date)return[];const{startOf:s}=f(e.period,e.date),a=e.summarize?["summary"]:["days",s];return(0,d.Z)(t,a.concat(["search_terms"]),[]).map((t=>({label:t.term,className:"user-selectable",value:t.views})))},statsFileDownloads(t,e){if(!t||!e.period||!e.date)return[];const{startOf:s}=f(e.period,e.date);return(0,d.Z)(t,["days",s,"files"],[]).map((t=>({label:t.relative_url,shortLabel:t.filename,page:null,value:t.downloads,link:t.download_url,linkTitle:t.relative_url,labelIcon:"external"})))},statsEmailsSummary(t,e,s,a){if(!t)return[];return(0,d.Z)(t,["posts"],[]).map((({id:t,href:e,date:s,title:r,type:n,opens:o,clicks:i})=>({id:t,href:e,date:s,label:r,type:n,value:i||"0",opens:o||"0",clicks:i||"0",page:a?`/stats/email/opens/day/${t}/${a.slug}`:null,actions:[{type:"link",data:e}]})))},statsEmailsSummaryByOpens:(t,e,s,a)=>M.statsEmailsSummary(t,e,s,a)}},"../packages/tree-select/src/index.ts":(t,e,s)=>{s.d(e,{Z:()=>r});const a=(...t)=>t.join();function r(t,e,s={}){let r=new WeakMap;const{getCacheKey:n=a}=s,i=function(s,...a){const i=t(s,...a);const l=i.reduce(o,r),u=n(...a);if(l.has(u))return l.get(u);const d=e(i,...a);return l.set(u,d),d};return i.clearCache=()=>{r=new WeakMap},i}const n={};function o(t,e,s,a){if(null!=e&&Object(e)!==e)throw new TypeError("key must be an object, `null`, or `undefined`");const r=e||n,o=t.get(r);if(o)return o;const i=s===a.length-1?new Map:new WeakMap;return t.set(r,i),i}}}]);